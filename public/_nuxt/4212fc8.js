(window.webpackJsonp=window.webpackJsonp||[]).push([[55,9],{525:function(t,e,n){"use strict";(function(t){var r=n(29),o=(n(41),n(32),n(40),n(175),n(84),n(551)),l=n(552),c=n.n(l);e.a={props:{value:{default:Object}},watch:{$props:{deep:!0,handler:function(t){this.props=JSON.parse(JSON.stringify(t)),this.props.value=this.valueDefault(this.props.value),this.playerInit()}}},data:function(){return{props:this.valueDefault(this.$props),lastPropsValueMidiUrl:!1,instrument:!1,soundfontLoaded:!1,player:!1,playerEvent:{},songPercent:0,editor:{zoomX:200}}},computed:{isPlaying:function(){return!!this.player&&this.player.isPlaying()},songTime:function(){return!!this.player&&this.player.getSongTime()},nextChords:function(){return[]},nextLyrics:function(){var t=this;if(!this.props.value)return[];if(!this.props.value.items)return[];if(0==this.props.value.items.length)return[];var e=this.props.value.items.filter((function(e){return e.percent>=t.songPercent&&"lyric"==e.type}));return 0==e.length&&(e=this.props.value.items.filter((function(t){return"lyric"==t.type}))).length>0&&(e=[e[e.length-1]]),e}},methods:{emitValue:function(){this.$emit("input",this.props.value)},valueDefault:function(t){var e=function(t,e){return t="object"==Object(r.a)(t)?t:{},e="object"==Object(r.a)(e)?e:{},JSON.parse(JSON.stringify(Object.assign({},t,e)))},n=e({id:!1,user_id:!1,artist_id:!1,slug:"",name:"",midi:{},items:[],user:{},chords_artist:{}},t);return n.chords_artist=e({id:!1,slug:"",name:"",cover:{}},n.chords_artist),n},playerInit:function(){var e=this;if(!this.props.value.midi||this.props.value.midi&&!this.props.value.midi.url){if(!+this.props.value.id)return;this.$axios.get("/api/chords-song/find/".concat(this.props.value.id)).then((function(t){e.props.value=t.data,e.emitValue(),e.playerInit()}))}else this.props.value.midi&&this.props.value.midi.url&&this.lastPropsValueMidiUrl!=this.props.value.midi.url&&(this.lastPropsValueMidiUrl=this.props.value.midi.url,function(){console.log("playerInit"),e.player=new o.a.Player((function(t){e.songPercent=Math.max(0,100-e.player.getSongPercentRemaining()),"Note on"==t.name&&e.instrument.play(t.noteName,AudioContext.currentTime,{gain:t.velocity/100})}));var content=e.props.value.midi.url.split(",")[1];content=t.from(content,"base64"),e.player.loadArrayBuffer(content),c.a.instrument(e.$audioContext,"marimba").then((function(t){e.instrument=t}))}())},play:function(){this.isPlaying?this.pause():this.player.play()},pause:function(){this.player.pause()},stop:function(){this.player.stop(),this.songPercent=Math.max(0,100-this.player.getSongPercentRemaining())},skipToPercent:function(t){var e=this,n=this.player.isPlaying();n&&this.player.stop(),setTimeout((function(){e.player.skipToPercent(t),n&&e.player.play(),e.songPercent=Math.max(0,100-e.player.getSongPercentRemaining())}),10)}},mounted:function(){this.playerInit()}}}).call(this,n(550).Buffer)},533:function(t,e,n){var content=n(542);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(56).default)("1ef8fdc1",content,!0,{sourceMap:!1})},541:function(t,e,n){"use strict";n(533)},542:function(t,e,n){(e=t.exports=n(55)(!1)).push([t.i,"._2boqgtdKNRgGLjYuLhoXMw{min-height:400px;background-image:linear-gradient(90deg,transparent 50%,#eee 0);background-size:5% 50%}",""]),e.locals={"midiplayer-editor-pattern":"_2boqgtdKNRgGLjYuLhoXMw"}},546:function(t,e,n){"use strict";n.r(e);var r=n(525).a,o=(n(541),n(18)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"bg-light shadow-sm"},[n("div",{staticClass:"p-2"},[t.props.value.link?n("h3",{staticClass:"m-0"},[n("nuxt-link",{attrs:{to:t.props.value.link.profile}},[t._v("\r\n                    "+t._s(t.props.value.name)+"\r\n                ")])],1):t._e(),t._v(" "),t.props.value.chords_artist&&t.props.value.chords_artist.link?n("h5",{staticClass:"m-0"},[n("nuxt-link",{attrs:{to:t.props.value.chords_artist.link.profile}},[t._v("\r\n                    "+t._s(t.props.value.chords_artist.name)+"\r\n                ")])],1):t._e()]),t._v(" "),t.props.value.midi&&t.props.value.midi.url?n("div",[n("div",{staticClass:"text-center",staticStyle:{height:"50px",overflow:"hidden"}},t._l(t.nextLyrics,(function(e){return n("div",[t._v(t._s(e.value))])})),0),t._v(" "),n("div",{staticClass:"d-flex align-items-center p-2"},[t.isPlaying?t._e():n("div",{staticClass:"pr-1"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.play()}}},[n("i",{staticClass:"fas fa-play"})])]),t._v(" "),t.isPlaying?n("div",{staticClass:"pr-1"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.pause()}}},[n("i",{staticClass:"fas fa-pause"})])]):t._e(),t._v(" "),n("div",{staticClass:"pr-1"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.stop()}}},[n("i",{staticClass:"fas fa-stop"})])]),t._v(" "),n("div",{staticClass:"flex-grow-1 pl-3"},[n("el-slider",{on:{change:function(e){return t.skipToPercent(e)}},model:{value:t.songPercent,callback:function(e){t.songPercent=e},expression:"songPercent"}})],1)])]):t._e()])])}),[],!1,null,null,null);e.default=component.exports},718:function(t,e,n){"use strict";n.r(e);var r=n(4),o=(n(28),{data:function(){return{model:!1,songs:[]}},fetch:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.$get("/api/chords-artist/find/".concat(t.$route.params.slug));case 2:if(t.model=e.sent,!t.model||!t.model.id){e.next=7;break}return e.next=6,t.$axios.$get("/api/chords-song/search/?artist_id=".concat(t.model.id));case 6:t.songs=e.sent;case 7:case"end":return e.stop()}}),e)})))()}}),l=n(18),component=Object(l.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.model?n("div",[t.model.cover&&t.model.cover.url?n("div",{staticClass:"mb-3"},[n("img",{staticStyle:{width:"100%","max-height":"300px","object-fit":"cover"},attrs:{src:t.model.cover.url,alt:"",width:"100%"}})]):t._e(),t._v(" "),n("div",{staticClass:"container"},[n("h1",{staticClass:"mb-3"},[t._v(t._s(t.model.name))]),t._v(" "),t._l(t.songs.data,(function(s){return n("div",{staticClass:"mb-3"},[n("midiplayer",{attrs:{value:s}})],1)}))],2)]):t._e()])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Midiplayer:n(546).default})}}]);