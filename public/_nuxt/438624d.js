(window.webpackJsonp=window.webpackJsonp||[]).push([[60,9],{525:function(t,e,r){"use strict";(function(t){var n=r(29),o=(r(41),r(32),r(40),r(175),r(84),r(551)),l=r(552),c=r.n(l);e.a={props:{value:{default:Object}},watch:{$props:{deep:!0,handler:function(t){this.props=JSON.parse(JSON.stringify(t)),this.props.value=this.valueDefault(this.props.value),this.playerInit()}}},data:function(){return{props:this.valueDefault(this.$props),lastPropsValueMidiUrl:!1,instrument:!1,soundfontLoaded:!1,player:!1,playerEvent:{},songPercent:0,editor:{zoomX:200}}},computed:{isPlaying:function(){return!!this.player&&this.player.isPlaying()},songTime:function(){return!!this.player&&this.player.getSongTime()},nextChords:function(){return[]},nextLyrics:function(){var t=this;if(!this.props.value)return[];if(!this.props.value.items)return[];if(0==this.props.value.items.length)return[];var e=this.props.value.items.filter((function(e){return e.percent>=t.songPercent&&"lyric"==e.type}));return 0==e.length&&(e=this.props.value.items.filter((function(t){return"lyric"==t.type}))).length>0&&(e=[e[e.length-1]]),e}},methods:{emitValue:function(){this.$emit("input",this.props.value)},valueDefault:function(t){var e=function(t,e){return t="object"==Object(n.a)(t)?t:{},e="object"==Object(n.a)(e)?e:{},JSON.parse(JSON.stringify(Object.assign({},t,e)))},r=e({id:!1,user_id:!1,artist_id:!1,slug:"",name:"",midi:{},items:[],user:{},chords_artist:{}},t);return r.chords_artist=e({id:!1,slug:"",name:"",cover:{}},r.chords_artist),r},playerInit:function(){var e=this;if(!this.props.value.midi||this.props.value.midi&&!this.props.value.midi.url){if(!+this.props.value.id)return;this.$axios.get("/api/chords-song/find/".concat(this.props.value.id)).then((function(t){e.props.value=t.data,e.emitValue(),e.playerInit()}))}else this.props.value.midi&&this.props.value.midi.url&&this.lastPropsValueMidiUrl!=this.props.value.midi.url&&(this.lastPropsValueMidiUrl=this.props.value.midi.url,function(){console.log("playerInit"),e.player=new o.a.Player((function(t){e.songPercent=Math.max(0,100-e.player.getSongPercentRemaining()),"Note on"==t.name&&e.instrument.play(t.noteName,AudioContext.currentTime,{gain:t.velocity/100})}));var content=e.props.value.midi.url.split(",")[1];content=t.from(content,"base64"),e.player.loadArrayBuffer(content),c.a.instrument(e.$audioContext,"marimba").then((function(t){e.instrument=t}))}())},play:function(){this.isPlaying?this.pause():this.player.play()},pause:function(){this.player.pause()},stop:function(){this.player.stop(),this.songPercent=Math.max(0,100-this.player.getSongPercentRemaining())},skipToPercent:function(t){var e=this,r=this.player.isPlaying();r&&this.player.stop(),setTimeout((function(){e.player.skipToPercent(t),r&&e.player.play(),e.songPercent=Math.max(0,100-e.player.getSongPercentRemaining())}),10)}},mounted:function(){this.playerInit()}}}).call(this,r(550).Buffer)},533:function(t,e,r){var content=r(542);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(56).default)("1ef8fdc1",content,!0,{sourceMap:!1})},541:function(t,e,r){"use strict";r(533)},542:function(t,e,r){(e=t.exports=r(55)(!1)).push([t.i,"._2boqgtdKNRgGLjYuLhoXMw{min-height:400px;background-image:linear-gradient(90deg,transparent 50%,#eee 0);background-size:5% 50%}",""]),e.locals={"midiplayer-editor-pattern":"_2boqgtdKNRgGLjYuLhoXMw"}},546:function(t,e,r){"use strict";r.r(e);var n=r(525).a,o=(r(541),r(18)),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"bg-light shadow-sm"},[r("div",{staticClass:"p-2"},[t.props.value.link?r("h3",{staticClass:"m-0"},[r("nuxt-link",{attrs:{to:t.props.value.link.profile}},[t._v("\r\n                    "+t._s(t.props.value.name)+"\r\n                ")])],1):t._e(),t._v(" "),t.props.value.chords_artist&&t.props.value.chords_artist.link?r("h5",{staticClass:"m-0"},[r("nuxt-link",{attrs:{to:t.props.value.chords_artist.link.profile}},[t._v("\r\n                    "+t._s(t.props.value.chords_artist.name)+"\r\n                ")])],1):t._e()]),t._v(" "),t.props.value.midi&&t.props.value.midi.url?r("div",[r("div",{staticClass:"text-center",staticStyle:{height:"50px",overflow:"hidden"}},t._l(t.nextLyrics,(function(e){return r("div",[t._v(t._s(e.value))])})),0),t._v(" "),r("div",{staticClass:"d-flex align-items-center p-2"},[t.isPlaying?t._e():r("div",{staticClass:"pr-1"},[r("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.play()}}},[r("i",{staticClass:"fas fa-play"})])]),t._v(" "),t.isPlaying?r("div",{staticClass:"pr-1"},[r("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.pause()}}},[r("i",{staticClass:"fas fa-pause"})])]):t._e(),t._v(" "),r("div",{staticClass:"pr-1"},[r("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.stop()}}},[r("i",{staticClass:"fas fa-stop"})])]),t._v(" "),r("div",{staticClass:"flex-grow-1 pl-3"},[r("el-slider",{on:{change:function(e){return t.skipToPercent(e)}},model:{value:t.songPercent,callback:function(e){t.songPercent=e},expression:"songPercent"}})],1)])]):t._e()])])}),[],!1,null,null,null);e.default=component.exports},719:function(t,e,r){"use strict";r.r(e);var n=r(4),o=(r(28),{data:function(){return{model:!1}},fetch:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.$get("/api/chords-song/find/".concat(t.$route.params.slug));case 2:t.model=e.sent;case 3:case"end":return e.stop()}}),e)})))()}}),l=r(18),component=Object(l.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t.model?r("div",[t.model.chords_artist&&t.model.chords_artist.cover&&t.model.chords_artist.cover.url?r("div",[r("img",{staticStyle:{width:"100%","max-height":"300px","object-fit":"cover"},attrs:{src:t.model.chords_artist.cover.url,alt:"",width:"100%"}})]):t._e(),t._v(" "),r("div",{staticClass:"container"},[r("h1",[t._v(t._s(t.model.name))]),t._v(" "),t.model.chords_artist?r("h2",[t._v(t._s(t.model.chords_artist.name))]):t._e(),t._v(" "),r("midiplayer",{attrs:{value:t.model}})],1)]):t._e()])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Midiplayer:r(546).default})}}]);